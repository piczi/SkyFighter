# SkyFighter

ä¸€æ¬¾åŸºäº React + Canvas å¼€å‘çš„ç»å…¸ç©ºæˆ˜å°„å‡»æ¸¸æˆ

## æ¸¸æˆåŠŸèƒ½

### æ ¸å¿ƒç©æ³•
- **è‡ªåŠ¨å°„å‡»**ï¼šç©å®¶é£æœºè‡ªåŠ¨å‘å°„å­å¼¹ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ
- **é¼ æ ‡/è§¦æ‘¸æ§åˆ¶**ï¼šç§»åŠ¨é¼ æ ‡æˆ–è§¦æ‘¸å±å¹•æ§åˆ¶é£æœºä½ç½®
- **é”®ç›˜æ§åˆ¶**ï¼š
  - `ç©ºæ ¼é”®`ï¼šæš‚åœ/ç»§ç»­æ¸¸æˆ
  - `Bé”®`ï¼šä½¿ç”¨ç‚¸å¼¹æ¸…å±

### æ¸¸æˆå…ƒç´ 
- **ç©å®¶é£æœº**ï¼šè“è‰²ä¸‰è§’å½¢æˆ˜æœºï¼Œå¸¦å¼•æ“ç«ç„°æ•ˆæœ
- **æ•Œäººç±»å‹**ï¼š
  - æ™®é€šæ•Œæœºï¼ˆçº¢è‰²å€’ä¸‰è§’ï¼‰ï¼šåŸºç¡€æ•Œäºº
  - å¿«é€Ÿæ•Œæœºï¼ˆé»„è‰²è±å½¢ï¼‰ï¼šé€Ÿåº¦å¿«ï¼Œè¡€é‡ä½
  - å¦å…‹æ•Œæœºï¼ˆç´«è‰²å¤§å‹å€’ä¸‰è§’ï¼‰ï¼šè¡€é‡é«˜ï¼Œé€Ÿåº¦æ…¢
  - å°„å‡»æ•Œæœºï¼ˆç»¿è‰²å€’ä¸‰è§’ï¼‰ï¼šä¼šå‘ç©å®¶å‘å°„å­å¼¹
- **é“å…·ç³»ç»Ÿ**ï¼š
  - âš¡ ç«åŠ›æå‡ï¼šå¢åŠ å­å¼¹æ•°é‡
  - ğŸ’£ ç‚¸å¼¹ï¼šæ¸…å±é“å…·
  - ğŸ›¡ æŠ¤ç›¾ï¼šä¿æŠ¤ç©å®¶å…å—ä¼¤å®³
- **çˆ†ç‚¸æ•ˆæœ**ï¼šç²’å­é£æ•£åŠ¨ç”»

### UI æ˜¾ç¤º
- åˆ†æ•°å’Œç­‰çº§
- è¡€æ¡å’ŒæŠ¤ç›¾æ¡
- ç‚¸å¼¹æ•°é‡
- ç«åŠ›ç­‰çº§
- å®æ—¶ FPS æ˜¾ç¤º

## æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **React 18**ï¼šUI ç»„ä»¶å’ŒçŠ¶æ€ç®¡ç†
- **Canvas 2D**ï¼šæ¸¸æˆæ¸²æŸ“å¼•æ“
- **requestAnimationFrame**ï¼šæ¸¸æˆå¾ªç¯
- **Vite**ï¼šæ„å»ºå·¥å…·

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥
1. **Ref ç›´æ¥æ›´æ–°**ï¼šæ¸¸æˆå®ä½“ï¼ˆç©å®¶ã€å­å¼¹ã€æ•Œäººï¼‰ä½¿ç”¨ `useRef` å­˜å‚¨ï¼Œé¿å… React é‡æ¸²æŸ“
2. **çŠ¶æ€æœ€å°åŒ–**ï¼šåªåœ¨å¿…è¦æ—¶ï¼ˆå¦‚å±æ€§å˜åŒ–ã€åˆ†æ•°å˜åŒ–ï¼‰è§¦å‘ React state æ›´æ–°
3. **ç‹¬ç«‹æ¸²æŸ“å¾ªç¯**ï¼šCanvas ç»˜åˆ¶ä½¿ç”¨ç‹¬ç«‹çš„ `requestAnimationFrame` å¾ªç¯
4. **ç¢°æ’æ£€æµ‹ä¼˜åŒ–**ï¼šä½¿ç”¨çº¿æ®µ-åœ†ç›¸äº¤ç®—æ³•æ£€æµ‹å­å¼¹è½¨è¿¹ï¼Œæé«˜æ£€æµ‹ç²¾åº¦

### ä»£ç ç»“æ„

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ CanvasGame.jsx    # æ¸¸æˆä¸»ç»„ä»¶ï¼Œè´Ÿè´£ Canvas æ¸²æŸ“å’Œäº‹ä»¶å¤„ç†
â”‚   â””â”€â”€ Game.css          # æ¸¸æˆæ ·å¼
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useGame.js        # æ¸¸æˆé€»è¾‘ hookï¼Œç®¡ç†æ¸¸æˆçŠ¶æ€å’Œæ¸¸æˆå¾ªç¯
â”œâ”€â”€ App.jsx               # åº”ç”¨å…¥å£
â”œâ”€â”€ main.jsx              # React æ¸²æŸ“å…¥å£
â””â”€â”€ index.css             # å…¨å±€æ ·å¼
```

## æ ¸å¿ƒé€»è¾‘è¯¦è§£

### æ¸¸æˆå¾ªç¯æœºåˆ¶

æ¸¸æˆä½¿ç”¨åŒå±‚å¾ªç¯æ¶æ„ï¼š

1. **React å±‚**ï¼šç®¡ç†æ¸¸æˆçŠ¶æ€ï¼ˆåˆ†æ•°ã€ç­‰çº§ã€é“å…·ç­‰ï¼‰ï¼Œè§¦å‘å¿…è¦çš„ UI æ›´æ–°
2. **Canvas å±‚**ï¼šä½¿ç”¨ `requestAnimationFrame` å®ç° 60FPS æ¸²æŸ“ï¼Œç›´æ¥ä» Ref è¯»å–å®æ—¶æ•°æ®

```javascript
// useGame.js ä¸­çš„æ¸¸æˆå¾ªç¯
useEffect(() => {
  const gameLoop = () => {
    // 1. æ›´æ–°ç©å®¶ä½ç½®
    // 2. è‡ªåŠ¨å°„å‡»
    // 3. ç”Ÿæˆæ•Œäºº
    // 4. æ›´æ–°æ•Œäººä½ç½®å’Œå°„å‡»
    // 5. æ›´æ–°å­å¼¹ä½ç½®
    // 6. ç¢°æ’æ£€æµ‹
    // 7. æ›´æ–°çˆ†ç‚¸æ•ˆæœ
    
    gameLoopRef.current = requestAnimationFrame(gameLoop);
  };
}, []);
```

### ç©å®¶ç§»åŠ¨

ç©å®¶é£æœºç›´æ¥è·Ÿéšé¼ æ ‡ä½ç½®ï¼Œæ¶ˆé™¤ç§»åŠ¨å»¶è¿Ÿï¼š

```javascript
// ç›´æ¥å°†ç©å®¶ä½ç½®è®¾ç½®ä¸ºé¼ æ ‡ä½ç½®
if (isTouchingRef.current) {
  const targetX = touchPositionRef.current.x;
  const targetY = touchPositionRef.current.y;
  playerRef.current = { ...playerRef.current, x: targetX, y: targetY };
}
```

### ç¢°æ’æ£€æµ‹ç®—æ³•

ä½¿ç”¨çº¿æ®µ-åœ†ç›¸äº¤æ£€æµ‹å­å¼¹è½¨è¿¹ï¼Œé˜²æ­¢é«˜é€Ÿå­å¼¹ç©¿é€æ•Œäººï¼š

```javascript
// æ£€æµ‹å­å¼¹è½¨è¿¹æ˜¯å¦ä¸æ•Œäººåœ†ç›¸äº¤
function segmentCircleIntersect(x1, y1, x2, y2, cx, cy, radius) {
  // è®¡ç®—çº¿æ®µåˆ°åœ†å¿ƒçš„æœ€çŸ­è·ç¦»
  const t = ((cx - x1) * dx + (cy - y1) * dy) / len2;
  // ...
  return distX * distX + distY * distY <= radius * radius;
}
```

### æ•Œäººå°„å‡»é€»è¾‘

å°„å‡»æ•Œæœºä¼šè®¡ç®—æŒ‡å‘ç©å®¶çš„è§’åº¦å¹¶å‘å°„è·Ÿè¸ªå¼¹ï¼š

```javascript
const dx = player.x - (enemy.x + enemy.size / 2);
const dy = player.y - (enemy.y + enemy.size / 2);
const dist = Math.sqrt(dx * dx + dy * dy);
const vx = (dx / dist) * speed;
const vy = (dy / dist) * speed;
```

### çˆ†ç‚¸ç²’å­ç³»ç»Ÿ

æ¯ä¸ªçˆ†ç‚¸ç”Ÿæˆ 15-20 ä¸ªéšæœºé¢œè‰²ã€é€Ÿåº¦ã€æ–¹å‘çš„ç²’å­ï¼š

```javascript
const particles = [];
for (let i = 0; i < 15; i++) {
  const angle = Math.random() * Math.PI * 2;
  const speed = Math.random() * 4 + 2;
  particles.push({
    x: 0, y: 0,
    vx: Math.cos(angle) * speed,
    vy: Math.sin(angle) * speed,
    life: 1,  // ç”Ÿå‘½å€¼ï¼Œé€æ¸å‡å°
    size: Math.random() * 6 + 3,
    color: '#ff6b6b' // æˆ– '#ffd93d', '#ff8800'
  });
}
```

## å¼€å‘æŒ‡å—

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- npm æˆ– yarn

### æœ¬åœ°å¼€å‘

1. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

2. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
   ```bash
   npm run dev
   ```

3. **è®¿é—®æ¸¸æˆ**
   æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5173`

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

æ„å»ºäº§ç‰©åœ¨ `dist/` ç›®å½•ä¸‹ã€‚

### ä»£ç è§„èŒƒ

é¡¹ç›®ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥ï¼š

```bash
npm run lint
```

### è°ƒè¯•æŠ€å·§

1. **FPS ç›‘æ§**ï¼šå³ä¸Šè§’å®æ—¶æ˜¾ç¤ºå¸§ç‡
2. **æµè§ˆå™¨å¼€å‘è€…å·¥å…·**ï¼š
   - Elements é¢æ¿ï¼šæ£€æŸ¥ Canvas DOM ç»“æ„
   - Console é¢æ¿ï¼šæŸ¥çœ‹æ—¥å¿—å’Œé”™è¯¯
   - Performance é¢æ¿ï¼šåˆ†ææ€§èƒ½ç“¶é¢ˆ

### å¸¸è§é—®é¢˜

**Q: é£æœºç§»åŠ¨æœ‰é‡å½±ï¼Ÿ**
A: ç¡®ä¿ä½¿ç”¨ `playerRef.current` è€Œé `player` state è¿›è¡Œæ¸²æŸ“ï¼Œé¿å…é¢‘ç¹é‡æ¸²æŸ“ã€‚

**Q: å­å¼¹ç©¿é€æ•Œäººï¼Ÿ**
A: ä½¿ç”¨çº¿æ®µ-åœ†ç›¸äº¤æ£€æµ‹å­å¼¹è½¨è¿¹ï¼Œè€Œéç®€å•ä½ç½®æ£€æµ‹ã€‚

**Q: æ¸¸æˆè¿è¡Œå¡é¡¿ï¼Ÿ**
A: æ£€æŸ¥ FPS æ˜¾ç¤ºï¼Œç¡®ä¿åœ¨ 55+ã€‚ä¼˜åŒ–æ–¹æ³•ï¼šå‡å°‘ç²’å­æ•°é‡ã€é™ä½ Canvas å¤æ‚åº¦ã€‚

## éƒ¨ç½²æŒ‡å—

### é™æ€æ‰˜ç®¡

æ„å»ºäº§ç‰© `dist/` å¯ç›´æ¥éƒ¨ç½²åˆ°ä»»ä½•é™æ€æ‰˜ç®¡æœåŠ¡ï¼š

**Vercel**
```bash
npm i -g vercel
vercel deploy --prod
```

**Netlify**
```bash
npm i -g netlify-cli
netlify deploy --prod --dir=dist
```

**GitHub Pages**
```bash
npm run build
# å°† dist ç›®å½•æ¨é€åˆ° gh-pages åˆ†æ”¯
```

### Docker éƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

åˆ›å»º `Dockerfile`ï¼š

```dockerfile
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

æ„å»ºå’Œè¿è¡Œï¼š
```bash
docker build -t plane-game .
docker run -p 80:80 plane-game
```

### Nginx é…ç½®

```nginx
server {
    listen 80;
    server_name localhost;
    root /usr/share/nginx/html;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # ç¼“å­˜é™æ€èµ„æº
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

## ç»´æŠ¤å»ºè®®

### æ€§èƒ½ç›‘æ§

1. **å®šæœŸæ£€æŸ¥ FPS**ï¼šç¡®ä¿åœ¨ç›®æ ‡è®¾å¤‡ä¸Šä¿æŒ 55+ FPS
2. **å†…å­˜æ³„æ¼æ£€æµ‹**ï¼šé•¿æ—¶é—´è¿è¡Œåæ£€æŸ¥æµè§ˆå™¨å†…å­˜ä½¿ç”¨
3. **ç¢°æ’æ£€æµ‹ä¼˜åŒ–**ï¼šå¦‚éœ€å¢åŠ æ•Œäººæ•°é‡ï¼Œè¯„ä¼°ç¢°æ’æ£€æµ‹ç®—æ³•çš„æ€§èƒ½å½±å“

### åŠŸèƒ½æ‰©å±•

**å¢åŠ æ–°æ•Œäººç±»å‹**ï¼š
1. åœ¨ `useGame.js` çš„ `enemyConfigs` ä¸­æ·»åŠ é…ç½®
2. åœ¨ `CanvasGame.jsx` çš„ `drawEnemy` ä¸­æ·»åŠ ç»˜åˆ¶é€»è¾‘
3. åœ¨ `spawnRate` æƒé‡æ•°ç»„ä¸­è°ƒæ•´å‡ºç°æ¦‚ç‡

**å¢åŠ æ–°é“å…·**ï¼š
1. åœ¨ `useGame.js` çš„é“å…·ç±»å‹æ•°ç»„ä¸­æ·»åŠ æ–°ç±»å‹
2. åœ¨ `drawItem` ä¸­æ·»åŠ ç»˜åˆ¶é€»è¾‘
3. åœ¨é“å…·æ”¶é›†é€»è¾‘ä¸­æ·»åŠ æ•ˆæœå¤„ç†

**è°ƒæ•´æ¸¸æˆéš¾åº¦**ï¼š
- ä¿®æ”¹ `SPAWN_INTERVAL`ï¼šæ•Œäººç”Ÿæˆé—´éš”
- ä¿®æ”¹ `ENEMY_SPEED`ï¼šæ•Œäººé€Ÿåº¦
- ä¿®æ”¹ `enemyConfigs` ä¸­å„ç±»å‹æ•Œäººçš„å±æ€§

### ç‰ˆæœ¬å†å²

- v1.0.0ï¼šåˆå§‹ç‰ˆæœ¬ï¼Œå®Œæ•´çš„ SkyFighter æ¸¸æˆåŠŸèƒ½
  - Canvas æ¸²æŸ“å¼•æ“
  - 4 ç§æ•Œäººç±»å‹
  - 3 ç§é“å…·
  - ç²’å­çˆ†ç‚¸æ•ˆæœ
  - FPS ç›‘æ§

## è®¸å¯è¯

MIT License
